<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Coordinate Test</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        canvas { border: 1px solid #000; }
    </style>
</head>
<body>
    <h1>Simple Coordinate System Test</h1>
    
    <div class="test-section">
        <h3>Coordinate Transformation Test</h3>
        <button onclick="testCoordinates()">Test Coordinates</button>
        <div id="results"></div>
    </div>
    
    <div class="test-section">
        <h3>Simple Canvas Test</h3>
        <canvas id="test-canvas" width="400" height="300"></canvas>
        <br>
        <button onclick="drawTest()">Draw Test Pattern</button>
        <button onclick="clearCanvas()">Clear Canvas</button>
    </div>

    <script type="module">
        import { coordinateSystem } from './src/utils/CoordinateSystem.js';
        
        // Make coordinate system available globally for testing
        window.coordinateSystem = coordinateSystem;
        
        function testCoordinates() {
            const results = document.getElementById('results');
            let output = '<h4>Coordinate Test Results:</h4>';
            
            // Test camera state
            const camera = { offsetX: 200, offsetY: 150, zoom: 1.0 };
            
            // Test screen to world
            const screenPos = { x: 200, y: 150 };
            const worldPos = coordinateSystem.screenToWorld(screenPos.x, screenPos.y, camera);
            output += `<p>Screen (${screenPos.x}, ${screenPos.y}) -> World (${worldPos.x.toFixed(2)}, ${worldPos.y.toFixed(2)})</p>`;
            
            // Test world to grid
            const gridPos = coordinateSystem.worldToGrid(worldPos.x, worldPos.y);
            output += `<p>World (${worldPos.x.toFixed(2)}, ${worldPos.y.toFixed(2)}) -> Grid (${gridPos.x}, ${gridPos.y})</p>`;
            
            // Test grid to world
            const worldPos2 = coordinateSystem.gridToWorld(gridPos.x, gridPos.y);
            output += `<p>Grid (${gridPos.x}, ${gridPos.y}) -> World (${worldPos2.x.toFixed(2)}, ${worldPos2.y.toFixed(2)})</p>`;
            
            // Test world to screen
            const screenPos2 = coordinateSystem.worldToScreen(worldPos2.x, worldPos2.y, camera);
            output += `<p>World (${worldPos2.x.toFixed(2)}, ${worldPos2.y.toFixed(2)}) -> Screen (${screenPos2.x.toFixed(2)}, ${screenPos2.y.toFixed(2)})</p>`;
            
            // Test block size
            output += `<p>Block Size: ${coordinateSystem.getBlockSize()}</p>`;
            
            results.innerHTML = output;
        }
        
        function drawTest() {
            const canvas = document.getElementById('test-canvas');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.fillStyle = '#f0f0f0';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid
            const camera = { offsetX: 0, offsetY: 0, zoom: 1.0 };
            coordinateSystem.drawGrid(ctx, camera, canvas.width, canvas.height, {
                showGrid: true,
                showMajorGrid: true,
                gridColor: 'rgba(0,0,0,0.2)',
                majorGridColor: 'rgba(0,0,0,0.4)',
                majorGridInterval: 5,
                minGridSize: 2
            });
            
            // Draw some test blocks
            ctx.fillStyle = 'red';
            ctx.fillRect(100, 100, 20, 20);
            
            ctx.fillStyle = 'blue';
            ctx.fillRect(200, 150, 20, 20);
            
            ctx.fillStyle = 'green';
            ctx.fillRect(300, 200, 20, 20);
        }
        
        function clearCanvas() {
            const canvas = document.getElementById('test-canvas');
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#f0f0f0';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }
        
        // Make functions available globally
        window.testCoordinates = testCoordinates;
        window.drawTest = drawTest;
        window.clearCanvas = clearCanvas;
        
        console.log('Coordinate system loaded:', coordinateSystem);
        console.log('Block size:', coordinateSystem.getBlockSize());
    </script>
</body>
</html>
